[Unit]
Description=CEDAR infrastructure service

[Service]
#User=root
#Group=root
Environment="CEDAR_HOME={{ cedar_home }}"
Environment="JAVA_HOME={{ cedar.java.home }}"
Environment="CEDAR_BIOPORTAL_API_KEY={{ cedar.bioportal_api_key }}"
WorkingDirectory={{ cedar_home }}
# infra-neo4j sometimes does not start when not properly shut down previously
# Running stopinfrastructure first ensures we start from a clean state
ExecStart=/usr/bin/bash -i -c "stopinfrastructure{{ cedar.external.suffix }} && startinfrastructure{{ cedar.external.suffix }}"
ExecStop=/usr/bin/bash -i -c stopinfrastructure{{ cedar.external.suffix }}
Restart=always

[Install]
WantedBy=multi-user.target
